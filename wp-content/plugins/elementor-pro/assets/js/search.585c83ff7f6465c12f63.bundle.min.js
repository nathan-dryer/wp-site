/*! elementor-pro - v3.23.0 - 26-06-2024 */
"use strict";(self.webpackChunkelementor_pro=self.webpackChunkelementor_pro||[]).push([[464],{6510:(e,t,s)=>{var n=s(3203);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(s(3231)),r=n(s(6399));class Search extends elementorModules.frontend.handlers.Base{constructor(){super(...arguments),(0,i.default)(this,"debounceTimeoutId",void 0)}getDefaultSettings(){return{selectors:{searchWrapper:".e-search",searchField:".e-search-input",submitButton:".e-search-submit",clearIcon:".e-search-input-wrapper > svg, .e-search-input-wrapper > i",searchIcon:".e-search-label > svg, .e-search-label > i",resultsContainer:".e-search-results"}}}getDefaultElements(){const e=this.getSettings("selectors");return{searchWidget:this.$element[0],searchWrapper:this.$element[0].querySelector(e.searchWrapper),searchField:this.$element[0].querySelector(e.searchField),submitButton:this.$element[0].querySelector(e.submitButton),clearIcon:this.$element[0].querySelector(e.clearIcon),searchIcon:this.$element[0].querySelector(e.searchIcon),resultsContainer:this.$element[0].querySelector(e.resultsContainer)}}onInit(){super.onInit(),this.changeClearIconVisibility(!0),this.updateInputStyle(),this.toggleSearchResultsVisibility=this.toggleSearchResultsVisibility.bind(this),document.addEventListener("click",this.toggleSearchResultsVisibility),document.fonts.ready.then((()=>this.updateInputStyle()))}onDestroy(){document.removeEventListener("click",this.toggleSearchResultsVisibility)}bindEvents(){this.elements.submitButton.addEventListener("click",this.onSubmit.bind(this)),this.elements.searchField.addEventListener("input",(e=>{this.changeClearIconVisibility(!e.target.value.length),this.debounce(this.onType)(e)})),this.elements.searchField.addEventListener("keydown",this.onSearchFieldKeydown.bind(this)),this.elements.searchWidget.addEventListener("click",this.onClick.bind(this)),["focusin","focusout"].forEach((e=>{this.elements.searchField.addEventListener(e,this.toggleWidgetFocusClass.bind(this))})),this.elements.clearIcon?.addEventListener("click",this.onClear.bind(this))}onClick(){this.elements.resultsContainer.classList.remove("hidden")}onType(e){if(e.preventDefault(),!this.elements.searchField.value.length)return void this.clearResultsMarkup();const t=this.getMinimumSearchLength();this.shouldShowLiveResults()&&this.elements.searchField.value.length>=t&&this.renderLiveResults()}toggleWidgetFocusClass(e){const t="focusin"===e.type;this.$element[0].classList.toggle("e-focus",t)}onSubmit(e){(elementorFrontend.isEditMode()||!this.shouldAllowClick(e)&&!this.shouldAllowEnter(e))&&e.preventDefault()}onClear(e){e.preventDefault(),this.elements.searchField.value="",this.clearResultsMarkup(),this.elements.searchField.focus(),this.changeClearIconVisibility(!0)}onSearchFieldKeydown(e){"Enter"===e.code&&this.onSubmit(e)}fetchUpdatedSearchWidgetMarkup(){return fetch(`${elementorProFrontend.config.urls.rest}elementor-pro/v1/refresh-search`,this.getFetchArgumentsForSearchUpdate())}getMinimumSearchLength(){return this.getElementSettings().minimum_search_characters||3}shouldShowLiveResults(){return this.getElementSettings().live_results&&this.getElementSettings().template_id}renderLiveResults(){if(document.querySelector(`.elementor-element-${this.getID()}`)){if(this.elements.searchField.value)return this.fetchUpdatedSearchWidgetMarkup().then((e=>e instanceof Response&&e?.ok&&!(400<=e?.status)?e.json():{})).catch((()=>({}))).then((e=>{if(!e?.data)return;const t=document.createElement("div");t.innerHTML=e.data,this.elements.resultsContainer.replaceChildren(t),this.maybeHandleNoResults(t)})).finally((()=>{const e=document.querySelectorAll(`[data-id="${this.getID()}"] .e-loop-item`);(0,r.default)(e),elementorFrontend.config.experimentalFeatures.e_lazyload&&document.dispatchEvent(new Event("elementor/lazyload/observe"))}));this.clearResultsMarkup()}}maybeHandleNoResults(e){const t=!!e.querySelector(".e-search-nothing-found-message");this.elements.resultsContainer.classList[t?"add":"remove"]("no-results")}clearResultsMarkup(){this.elements.resultsContainer.innerHTML=""}getFetchArgumentsForSearchUpdate(){const e=this.prepareSearchUpdateRequestData(),t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return elementorFrontend.isEditMode()&&elementorPro.config.eSearch?.nonce&&(t.headers["X-WP-Nonce"]=elementorPro.config.eSearch?.nonce),t}prepareSearchUpdateRequestData(){const e=""+this.getID(),t={post_id:this.getClosestDataElementorId(this.$element[0]),widget_id:e,search_term:this.elements.searchField.value||""};if(elementorFrontend.isEditMode()){const s=window.top.$e.components.get("document").utils.findContainerById(e);t.widget_model=s.model.toJSON({remove:["default","editSettings","defaultEditSettings"]}),t.is_edit_mode=!0}return t}getClosestDataElementorId(e){const t=e.closest("[data-elementor-id]");return t?t.getAttribute("data-elementor-id"):0}shouldAllowEnter(e){return+e.detail<=0&&this.getSubmitTrigger().enter}shouldAllowClick(e){return+e.detail>0&&this.getSubmitTrigger().click}getSubmitTrigger(){const e=this.getElementSettings("submit_trigger");return{click:"key_enter"!==e,enter:"click_submit"!==e}}debounce(e){var t=this;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];clearTimeout(t.debounceTimeoutId),t.debounceTimeoutId=setTimeout((()=>e.apply(t,i)),s)}}updateInputStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["searchIcon","clearIcon"];const t={searchIcon:"icon-label",clearIcon:"icon-clear"},s=this.$element[0].style,n=this.getAllDisplayNoneParents(this.$element[0].parentNode);this.setElementsDisplay(n,"block");for(const n of e){const{width:e}=this.elements[n]?.getBoundingClientRect()||{width:0},i=t[n];s.setProperty(`--e-search-${i}-absolute-width`,e+"px"),this.elements.searchField.classList[e?"remove":"add"](`no-${i}`)}this.setElementsDisplay(n,""),this.elements.searchWrapper.classList.remove("hidden")}changeClearIconVisibility(e){this.elements.clearIcon?.classList[e?"add":"remove"]("hidden")}toggleSearchResultsVisibility(e){const t=this.getSettings("selectors"),s=`.elementor-element-${this.getID()}`,n=!!e?.target?.closest(`${s} ${t.searchWrapper}`),i=e?.target?.classList?.contains(t.searchField.replace(".","")),r=this.elements.resultsContainer?.children?.length;r&&(i&&n||this.elements.resultsContainer.classList.add("hidden"))}getAllDisplayNoneParents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||e===document.body)return t;return"none"===window.getComputedStyle(e).display&&t.push(e),this.getAllDisplayNoneParents(e.parentNode,t)}setElementsDisplay(e,t){e.forEach((e=>{e.style.display=t}))}onElementChange(e){const t={search_field_icon_label_size:()=>this.updateInputStyle(["searchIcon"]),icon_clear_size:()=>this.updateInputStyle(["clearIcon"])};t[e]&&t[e]()}}t.default=Search}}]);